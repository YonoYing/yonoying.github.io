---
title: 'Pinball Detection using YOLO'
date: 2024/11/03
permalink: /posts/2024/11/pinball-yolo/
tags:
---

I wanted to learn about fast object tracking for video streams, epecially using ML techniques. I play pinball competitively down here in Weillington, and I thought it could be cool application for object tracking for a leanring project. 

I looked into existing work a bit and found this [paper](https://medium.com/better-programming/using-ai-to-automate-a-pinball-machine-ef5721141f03) on pinball tracking using contour filtering. I downloaded the repo, gave it a try on some youtube clips, and found it worked quite well. It struggled to track fast moving areas like bumpers and occluded areas like ramps and orbits (the semicircular paths at the back of pinball tables). 

I looked up ML methods for fast object tracking and found that YOLO seems to be a go-to algorithm, so I put together a colab notebook [link](https://colab.research.google.com/drive/1Kz2z_0XGtps2NwElRoyH9Jy2ym2h1Wdk?usp=sharing) to do a short experiment and see if YOLO was fast enough for pinball. I sampled three 15 second long videos at 20fps for a set of 900 training frames, manually labelled them, and tested the trained result on a clip from the game Roadshow. A screenshot from the result can be seen below. It achieved results that had similar limitations to the contour filtering aproach, and labelling was time consuming. 

<image src="/images/roadshow.jpg" width="320" height="240" controls></image> 

I intend to pick this project back up soon. I discovered recently that there is a Unity package called Visual Pinball that allows virtual tables created for pinball simulators to be imported into Unity. This would enable swift constrution of synthetic data that could allow for much better training results. Unity also has a package for "uglifying" visual data that could make the synthetic footage more robust. I also intent add a DeepSORT step to the tracking process to see if it improves the tracking in fast areas of the tables (bumpers). 


